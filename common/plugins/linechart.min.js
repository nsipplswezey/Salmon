var lcgraphs={};function linechart(G,h,am,an,X,at,ah,g,W,ar,u,c,C,w,O,ap,ab,H){var aj,ae,ac,L,r,t,f,aq,a=h,d=am,l=an;var o=G.substring(1);var j=X,N=at;var ao=(C)?C:false;var au=(O)?O:false;var v=(ap=="compare")?1:0;var ai=w||["blue","red","green","cyan","magenta"];var b=(W)?W:0,B=(ar)?ar:0;var R=(u)?u:100;var af=ab,ad=H;var p=(c)?c:false;var ak=[],al=40;var K=[];var i=(ah)?ah:function(m){return m.y};var D=(g)?g:function(m){return m.x};var z=(W||ar)?true:false;var e={ya:function(x,m){return ah(x)-ah(m)},yd:function(x,m){return ah(m)-ah(x)},xa:function(x,m){return g(x)-g(m)},xd:function(x,m){return g(m)-g(x)}};var E=null,n=null;function q(m,x){a=m-l.left-l.right-20;d=x-l.top-l.bottom-20;ae=d3.scale.linear().range([0,a]);ac=d3.scale.linear().range([d,0]);L=d3.svg.axis().scale(ae).orient("bottom");r=d3.svg.axis().scale(ac).orient("left");t=d3.svg.line().x(function(y){return ae(D(y))}).y(function(y){return ac(i(y))})}function M(){d3.select(G).select("svg").remove();var m;var aw,av,ax;if(ao){if(E==null){aw=d3.select(G).insert("table").attr("id",o+"_color");av=aw.append("tr");E=av.append("td").style({width:"300px","padding-left":"5px","padding-bottom":"5px"}).insert("form");ax=E.selectAll("span").data(ai).enter().append("span").style({"padding-left":"5px"});ax.append("input").attr("id",function(ay){return ay+"_button"}).attr("type","radio").attr("name",o+"_colorButton").attr("value",function(ay){return ay}).property("checked",function(az,ay){return(ay==0)});ax.append("label").attr("for",function(ay){return ay+"_button"}).append("svg").attr({width:"10px",height:"10px"}).append("rect").attr({width:"10px",height:"10px",fill:function(ay){return ay}})}}if(au){if(n==null){if(!ao){aw=d3.select(G).insert("table").attr("id",o+"_color");av=aw.append("tr");av.insert("td").style({width:"300px","padding-left":"5px","padding-bottom":"5px"})}n=av.insert("td").style({"white-space":"nowrap","padding-right":"5px","text-align":"right"});ax=n.selectAll("span").data(["normal","compare"]).enter().append("span").style({"padding-left":"5px"});ax.append("input").attr("id",function(ay){return ay+"_button"}).attr("type","radio").attr("name",o+"_modeButton").attr("onClick",function(az,ay){return"document.getElementById('"+o+"_c_reset').disabled = "+(ay==0)+"; lcgraphs['"+o+"']()"}).attr("value",function(ay){return ay}).property("checked",function(az,ay){return(ay==v)});ax.append("label").attr("for",function(ay){return ay+"_button"}).text(function(ay){return ay});n.append("span").style("padding-left","5px").append("button").attr({name:"compare_reset",id:o+"_c_reset",onClick:"d3.select('"+G+"').select('svg').select('.datapaths').selectAll('path').remove();lcgraphs['"+o+"']();"}).property("disabled",v==0).text("Reset")}}if(au||ao){m=d3.select(G).insert("svg",G+"_color")}else{m=d3.select(G).append("svg")}f=m.attr("width",a+l.left+l.right).attr("height",d+l.top+l.bottom).append("g").attr("class","g_main_linechart").attr("transform","translate("+l.left+","+l.top+")");if(af){f.append("text").attr("transform","translate(0, -20)").text(af)}if(ad){var x=[];for(var y=0;y<ad.length;y++){x.push({txt:ad[y],col:ai[y%ai.length]})}f.selectAll(".legend").data(x).enter().append("g").attr("class","legend").attr("transform",function(az,ay){return"translate("+(150+ay*50)+", -20)"}).each(function(ay){d3.select(this).append("text").attr("transform","translate(0, -5)").text(function(az){return az.txt});d3.select(this).append("rect").attr("transform","translate(10, 0)").attr({width:"10px",height:"10px",fill:function(az){return az.col}})})}aq=f.append("g").attr("class","datapaths");f.on("mousemove",function(){cx=d3.mouse(this)[0];cy=d3.mouse(this)[1];Q(cx,cy);T(cx,cy,this)}).on("mouseover",function(){d3.selectAll(".line_over").style("display","block");cx=d3.mouse(this)[0];cy=d3.mouse(this)[1];Q(cx,cy);T(cx,cy,this)}).on("mouseout",function(){d3.selectAll(".line_over").style("display","none");d3.selectAll(".ttip").remove();d3.selectAll(".flash_rect").remove()}).append("rect").attr("class","click-capture").style("visibility","hidden").attr("x",0).attr("y",0).attr("width",a).attr("height",d);f.append("line").attr("class","line_over").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",d).attr("stroke-dasharray",(5,5)).attr("display","none");s()}function s(){f.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(L);f.append("g").attr("class",function(x,m){return"y axis"}).call(r)}function S(){ak=[[]]}function U(){ae.domain([j,N]);ac.domain([b,B]);M()}function J(){if(z){return}var ax=K.concat(ak);if(ax.length==1){yExtent=d3.extent(ax[0],i);ac.domain(yExtent)}else{var m=new Array();for(var av=0;av<ax.length;av++){if(ax[av].length==0){continue}m[av]=d3.extent(ax[av],i)}var y=m.map(function(az){return az[0]});var ay=m.map(function(az){return az[1]});var aw=Math.min.apply(null,y);var x=Math.max.apply(null,ay);ac.domain([aw,x])}d3.select(G).select(".y.axis").call(r)}function aa(m){aj=f.select(".datapaths").selectAll("path");aj.remove();aj=f.select(".datapaths").selectAll("path").data(m,function(y,x){return(y.chartId)?y.chartId:x}).attr("class","line").attr("stroke",function(x){return(!x.stroke)?"steelblue":(x.stroke instanceof Array)?x.stroke[x.seq]:x.stroke}).attr("d",t).enter().append("path").attr("class","line").attr("stroke",function(x){return(!x.stroke)?"steelblue":(x.stroke instanceof Array)?x.stroke[x.seq]:x.stroke}).attr("d",t)}function Q(m,x){if(m<j){d3.selectAll(".line_over").style("display","none")}else{d3.selectAll(".line_over").attr("x1",m).attr("y1",0).attr("x2",m).attr("y2",d).style("display","block")}}function T(m,av,y){var x=ae.invert(m);d3.selectAll(".ttip").remove();d3.selectAll(".flash_rect").remove();if(x<j||x>N){return}d3.select(y).selectAll(".ttip").data(ak).enter().append("text").attr("class","ttip").attr("transform",function(ax,aw){return"translate("+aw*R+", "+(d+al)+")"}).style("fill",function(aw){return(!aw.stroke)?"steelblue":(aw.stroke instanceof Array)?aw.stroke[aw.seq]:aw.stroke}).style("fill",function(aw){return(aw.stroke)?aw.stroke:"steelblue"}).text(function(ax){var aw=I(ae.invert(m),ax);if(typeof aw=="number"){return sprintf("%10.5f, %10.5f",x,aw)}return sprintf("%10.5f, ------",x)})}function I(m,aA){var y=null;for(var aw=0;aw<aA.length;aw++){if(D(aA[aw])==m){return i(aA[aw])}if(D(aA[aw])>m&&aw>0){var ax=D(aA[aw-1]);var az=i(aA[aw-1]);var av=D(aA[aw]);var ay=i(aA[aw]);return az+(ay-az)*(m-ax)/(av-ax)}}return null}function A(m,x){q(m,x);U();J();aa(K.concat(ak))}function Y(y,x){ak=(y[0] instanceof Array)?y:[y];if(ao){ak[0].stroke=P(o+"_colorButton")}if(x){for(var m=0;m<y.length;m++){y[m].sort(e[x])}}J();aa(K.concat(ak))}function Z(){aj=f.select(".datapaths").selectAll("path");aj.remove();S()}function V(){return p||P(o+"_modeButton")=="compare"}function ag(m){if(m&&"hi" in m){N=m.hi}q(h,am);if(V()&&ak.length>0&&ak[0].length>0){K.push(ak[0])}S();U();J();aa(K)}function F(){return ak}function P(m){var y=document.getElementsByName(m);for(var x=0;x<y.length;x++){if(y[x].checked){return y[x].value}}return null}function k(){ag();K=[];ag()}lcgraphs[o]=k;ag();return{render:Y,reset:ag,resetCompare:Z,getData:F}};